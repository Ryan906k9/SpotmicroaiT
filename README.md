# 项目概述

本项目是基于 SpotMicroAI 机器狗开发项目。

项目预期分为三个阶段：

1. 按照 SpotMicroAI 构建机械结构和遥控体系。
2. 使用模拟器，基于强化学习训练专属的步态。
3. 添加摄像头等感知装置，实现机器狗自行避障。
4. 增加目标检测算法，实现机器狗跟随模式。

# 第一阶段

## 1. 构建 3d 结构

遇到的问题：

1. 3D 打印没有设置支撑
2. 3D 打印支撑结构去除困难
3. 3D 打印后拼接困难
4. 使用的螺丝型号无法确定
6. 舵机和机械结构要同步安装，否则有些地方固定了舵机装不进去

## 2. 连接电子元件

元件目录：

1. 树莓派 3b
2. TF（MicroSD）卡 32G
3. TF 卡读卡器
4. 杜邦线
5. PCA9685 舵机控制板 * 2
6. 平头 18650 锂电池 2600mAh * 4
7. 18650 锂电池专用电池盒（容量4节电池）
8. DC-DC 可调降压模块 * 2
9. MG996R 舵机 * 12
10. 蓝屏 LCD1602+I2C
11. KCD1 开关

机械元件：

1. 螺丝
2. 轴承（内径 d=5mm，外经 D=16mm）* 8

工具：

1. 热熔胶枪
2. 热熔胶
3. 螺丝刀

额外元件：

1. 树莓派 3b 铝合金散热外壳（带风扇）
该散热器导致 wifi 连接被屏蔽，下载巨慢！！！


遇到的问题

1. LCD 屏幕购买错误，只买了裸屏，没有 I2C 模块
2. 开关型号错了，尺寸对不上开孔，需要KCD1，对应开孔尺寸 20mm*13mm 左右
3. 电源模块莫名其妙就坏了，应该是 5v 的输出，结果直接等于输入电压了
4. xbox360 的手柄无法使用
5. PS4 的手柄，可以连上，但是一旦关机后再打开，树莓派显示连接上，但是手柄显示未连接
6. 原始教程的电路连接上 SCL 和 SDA 接反了
7. 开关的连接可以用焊接，缠绕，或者冷压端子
8. 购买了树莓派专用的无线键盘作为手柄的替代品，后面软件设置还有待研究怎么修改
9. 重新购买了八位堂的手柄，官方表示可以蓝牙支持树莓派
10. 连接手柄发现使用 mac linux 的不行，能连上但是检测不到，要用 安卓的才行
11. LCD 没有显示，查了 log 发现没有出现 error，查了产品介绍说可以调整对比度～～



## 3. 软件系统搭建

遇到的问题

1. 两块 PCA9685 由于型号一样，所以硬件地址一样，导致 I2C 控制的时候出了问题
2. 安装 RPi.GPIO 报错
3. 需要针对新的无线键盘修改程序，原来的程序是针对蓝牙连接的，但现在的连接方式是2.4g
4. 发现 python3.9 冲突报错，需要降级 python，决定装一个 miniconda
5. 安装 python3.6 的虚拟环境，重新安装依赖库，安装 setuptools 总是超时，换了源都不行～～～，只有 3 kB/s
6. 按键地址和原来的不同，不知道按哪个启动
7. 伺服器地址还是有问题，看了这个代码只能用 2 个 PCA9685，尝试更改硬件地址
8. 有可能不是 PCA9685 的问题，再尝试修改一下 json 代码
9. 日志 .log 文件只显示 info，不显示 error 和 debug 信息
10. 虚拟环境下无法安装 busio
11. sudo apt-get install python3.6 重新安装 python，结果安装成了 python3.4
12. 发现是 miniconda 的 python3.4
12. 删除了 miniconda 后终于显示 Python 3.6.15
14. 所有后续程序需要在 venv 虚拟环境中，source venv/bin/activate
15. ModuleNotFoundError: No module named '_curses'
16. 网上说是 3.6 的问题，重新安装 3.5
17. sudo apt update -y 速度太慢，总是超时，需要修改相应的配置文件阻止超时退出，或者增加源列表，但是没有文本编辑器，下载修改后无法上传，可能是权限问题。安装 gedit 要 589MB，放弃，安装 vim 报错提示要先 update，陷入死循环。只能硬着头皮继续 sudo apt update -y，貌似下载的缓存是可以继续用的，不用每次从零开始。经过了将近半小时 10 次续传后，完成。
18. 执行 ~/spotmicroai/utilities/activate.sh 提示不支持 python3.5，决定从头开始搞一遍
19. 重新安装超过了 20 小时，下载速度太慢
20. ssh key 报错，把 known_hosts 中的对应 IP 的语句删除
21. pip 出现了 ssl 报错
22. pip 安装使用清华源无效，估计是字母排序问题，换阿里云解决一部分
23. 最后彻底换掉才行，使用了 nano 编辑器
24. GPIO 17 果然位置错了！
25. 手柄需要先 pair，再 connect
26. 手柄按键的轴对不上，需要查看每个按键对应的代码
27. 供电问题，电压不够导致没法往前走
28. 舵机的扭矩可能不够，但是整个机器狗的重量是 3.2kg，舵机 13kg 的扭矩照理来说应该够了才对
29. 加大了供电电压，达到7v，勉强可以站立
30. 发现前期的校准出现了问题，左右不平衡，会倒

## 4. 舵机校准

遇到的问题

1. import busio 报错
2. 输入角度后舵机转动，但是这并没有完成校准

通过输入对应的角度尝试，让舵机转动到我们需要的 rest 时候的位置，然后记录下这个时候的角度值
并将该值写入到 json 文件中
这样确保机器狗启动的时候，即 rest 状态的时候，可以读取到正确的角度位置。